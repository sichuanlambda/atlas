# 2026-02-16

## Architecture Helper — Major Progress Day

### Browser Setup
- Headless Chromium working on VPS via Playwright's bundled binary
- Config: `browser.headless: true`, `browser.noSandbox: true`, `browser.executablePath: /home/openclaw/.cache/ms-playwright/chromium-1208/chrome-linux/chrome`
- Nathan installed missing libs (libnspr4, libnss3, etc.) for Playwright Chromium

### Account & Admin
- Created atlas@architecturehelper.com account (password: AtlasArch2025!)
- Nathan made this account admin
- Admin panel at /admin/places — can create/edit/manage places directly

### City Guides — SF & Chicago (LIVE)
- Submitted 17 buildings through the real UI analyze flow (not seeded):
  - SF (8): Transamerica Pyramid (868), Painted Ladies (869), SFMOMA (870), Ferry Building (871), Salesforce Tower (872), Coit Tower (873), Palace of Fine Arts (874), SF City Hall (875)
  - Chicago (9): Willis Tower (876), 860 Lake Shore Dr (877), Art Institute (878), Hancock Center (879), Rookery Building (880), Wrigley Building (881), Marina City (882), Aqua Tower (883), Cultural Center (884)
- Images sourced via Unsplash search API + Wikipedia REST API, verified with vision model
- First batch (IDs 858-867) had wrong images (random Unsplash IDs = Golden Gate Bridge, Swiss Alps, cycling race) — removed from library
- Created Place records via admin UI with hand-written rich HTML content
- Both places published + featured, live at /places/san-francisco and /places/chicago

### PRs
- PR #3 (city guide seeder) — superseded, can close. Did everything directly instead.
- PR #4 (style normalization, dirty branch) — superseded by PR #5
- **PR #5** (style normalization, clean): Rewrote StyleNormalizer with ~40 canonical groups covering 150+ variants. Fixes duplicate badges, consolidates synonyms. After deploy: `heroku run rake styles:normalize_all`
- **PR #6** (UI fixes): Fix building count capped at 10 (.limit(10) bug), add Select All to tour builder, show up to 3 style pills on library cards with +N indicator

### Key Findings
- `PlaceContentGenerator#generate_content_with_ai` was hardcoded to return nil — all city guides had generic fallback. Fix is in PR #5's branch but not critical since we wrote content by hand.
- `building_analyses_in_place` had `.limit(10)` causing all places to show max "10 buildings analyzed"
- GPT prompt for building analysis includes 100+ overlapping styles causing fragmentation
- StyleNormalizer previously only did regex matching, no semantic grouping
- Building show page re-extracted H3s from HTML instead of using stored h3_contents, causing duplicate badges (styles appear in both Influences and Details sections)

### Technical Notes
- CDP (Chrome DevTools Protocol) via WebSocket works for form automation when Playwright act/navigate unavailable
- Unsplash napi search endpoint: `https://unsplash.com/napi/search/photos?query=X&per_page=1` (no API key needed)
- Wikipedia REST API for building images: `https://en.wikipedia.org/api/rest_v1/page/summary/ARTICLE_NAME`
- Wikimedia Commons rate-limits this server's IP (429s) — use Wikipedia API instead

---

## Evening Session (continued)

### PRs #5-#8 All Merged & Deployed
- **PR #5**: Style normalization — `heroku run rake styles:normalize_all` completed
- **PR #6**: Building count fix, Select All, multi-style cards — deployed
- **PR #7**: Async GPT analysis via ProcessBuildingAnalysisJob (fixes R12 timeouts) + admin building management (search, delete, bulk actions, visibility toggle). The `create` action now saves record immediately and enqueues background job. Worker dyno handles GPT.
- **PR #8**: OG meta tags on place pages (og:title, og:description, og:image, twitter:card), external image URL support on submission form, optional building name column (migration: `add_column :building_analyses, :name, :string`), admin bulk import endpoint (`POST /admin/building_analyses/bulk_import`).

### New Orleans City Guide — LIVE
- 14 buildings submitted with proper Wikipedia/Wikimedia images (IDs 921-934)
- All have full GPT analysis with style badges
- Buildings: Cathedral (928), Cabildo (929), Pontalba (930), Monteleone (931), Preservation Hall (932), Gallier Hall (933), Longue Vue (934), McGehee School (921), Pitot House (922), Old US Mint (923), Saenger Theatre (924), Shotgun House (925), CAC (926), NOMA (927)
- SEO copy deployed to place page — evergreen (no hardcoded counts/IDs), neighborhood sections
- Place page: app.architecturehelper.com/places/new-orleans
- Image optimization with Pillow before upload (70-95% size reduction) — critical for staying under Heroku 30s timeout
- Earlier attempts created broken shell records (885-920) — all cleaned up

### R12 Timeout Root Cause
- Memory was at 72% (738MB/1024MB), spiking during submissions
- GPT calls took 15-30s synchronously in web dyno, causing R12 timeouts
- Fix: PR #7 moved analysis to existing ProcessBuildingAnalysisJob (was defined but never called!)
- Show page already had "Hang tight" polling UI — worked seamlessly with async flow

### City Research
- Scored 14 US cities for next guides
- Top picks: NYC (#1 for traffic), New Orleans (#2 for SEO gap) — NOLA done
- Honorable mentions: Philadelphia, Detroit for future rounds
- Full research at memory/city-research-2025-07-18.md

### Atlas Dashboard — LIVE
- Repo: github.com/sichuanlambda/atlas (Atlas has push access)
- URL: sichuanlambda.github.io/atlas
- Redesigned: light blueprint theme, teal accents, Georgia serif
- Sections: status, metrics, workstreams, waiting-on-Nathan, ideas, activity feed
- File sharing workspace: files/drafts/, files/research/, files/content/, files/from-nathan/
- Pinterest tracking section added: pins, boards, queue, template, metrics

### Pinterest — LIVE
- Business account: Architecture Helper (@nathaninproduct), login nathaninproduct@gmail.com
- Credentials stored: ~/.config/secrets/pinterest.env
- 10 boards created: 4 city (NOLA, SF, Chicago, Denver) + 6 style (Gothic, Beaux-Arts, Neoclassical, Art Deco, Victorian, Baroque)
- 2 pins published: St. Louis Cathedral (pin/1143281055425831346), Saenger Theatre (pin/1143281055425831772)
- Pin creation method: "Save from website" flow at pinterest.com/pin-builder/?tab=save_from_url — enter building URL, Pinterest pulls the image from S3
- Content template v1: "{building_name} | {primary_style} Architecture in {city}"
- Pin tracking JSON: memory/pinterest-pins.json (pins array, queue, templates, metrics)
- **Cron: 4x daily posting** (09:00, 13:00, 17:00, 21:00 UTC) — job ID bc621e88
- **Cron: 3-day performance review** (10:00 UTC every 3rd day) — job ID 9bfc068d
- 12 NOLA buildings queued for next 3 days

### Pinterest Algo Notes (from Sprout Social 2026)
- 4 ranking signals: pin quality, pinner quality, relevance, freshness
- Consistency > volume for new accounts (3-5 pins/day sweet spot)
- Keywords in titles + descriptions critical (Pinterest = search engine)
- Vertical images (2:3) get priority
- Fresh URLs get early visibility boost
- 85% of weekly users have purchased from a Pin

### Nathan's X Post
- Posted about OpenClaw + Architecture Helper experience
- Key voice notes captured in USER.md: no em dashes, uses "&", personal story not technical flex, ends with market thesis, references real struggles honestly
- His framing: "new class of businesses built upon the shoulders of AI agents"

### GitHub Token
- New token (classic PAT, full repo scope) covers both sichuanlambda/feedback-loop and sichuanlambda/atlas
- Stored at ~/.config/secrets/github-atlas.env and ~/.config/secrets/github-architecturehelper.env

### Ready for Next
- NYC city guide: research done, ready to execute with improved pipeline (bulk import, image optimization, external URLs)
- Programmatic SEO pages: auto-generate style-by-city pages — idea stage
- Reddit drafts: ready to post (memory/nola-reddit-drafts.md)
